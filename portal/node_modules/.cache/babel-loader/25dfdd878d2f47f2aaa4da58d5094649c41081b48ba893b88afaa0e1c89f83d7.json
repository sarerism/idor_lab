{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useSearchParams}from\"react-router-dom\";import{Card,CardHeader,CardBody,CardTitle,Table,Row,Col,Badge,Alert}from\"reactstrap\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Teams(){const[employees,setEmployees]=useState([]);const[loading,setLoading]=useState(true);const[accessDenied,setAccessDenied]=useState(false);const[loggedInUser,setLoggedInUser]=useState(null);const[searchParams]=useSearchParams();const uid=searchParams.get(\"uid\");useEffect(()=>{const userData=localStorage.getItem(\"user\");if(userData){const parsedUser=JSON.parse(userData);setLoggedInUser(parsedUser);// Check if the uid in URL matches the logged-in user\nif(uid&&uid!==parsedUser.employee_id){setAccessDenied(true);}else{setAccessDenied(false);fetchEmployees();}}},[uid]);const fetchEmployees=async()=>{try{const response=await fetch(\"/api/employees.php\");const data=await response.json();if(data.success){setEmployees(data.data);}}catch(error){console.error(\"Error fetching employees:\",error);}finally{setLoading(false);}};const getInitials=name=>{return name.split(\" \").map(n=>n[0]).join(\"\").toUpperCase();};if(accessDenied){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Alert,{color:\"danger\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"alert-heading\",children:\"Access Denied\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You don't have permission to view this page. You are trying to access data for user ID: \",/*#__PURE__*/_jsx(\"strong\",{children:uid})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Your user ID is: \",/*#__PURE__*/_jsx(\"strong\",{children:loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.employee_id})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-0\",children:\"Please use the navigation menu to access your own data.\"})]})})})})})});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsx(CardTitle,{tag:\"h4\",children:\"Team Members\"}),/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:\"All employees in the organization\"})]}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Table,{responsive:true,children:[/*#__PURE__*/_jsx(\"thead\",{className:\"text-primary\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Department\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Manager\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:loading?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",className:\"text-center\",children:\"Loading...\"})}):employees.length>0?employees.map(employee=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:employee.employee_id}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar mr-2\",style:{backgroundColor:\"#51cbce\",width:\"30px\",height:\"30px\",borderRadius:\"50%\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",color:\"white\",fontWeight:\"bold\",fontSize:\"12px\"},children:getInitials(employee.full_name)}),employee.full_name]})}),/*#__PURE__*/_jsx(\"td\",{children:employee.email}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{color:\"info\",children:employee.department})}),/*#__PURE__*/_jsx(\"td\",{children:employee.role}),/*#__PURE__*/_jsx(\"td\",{children:employee.manager_name||\"N/A\"})]},employee.employee_id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",className:\"text-center\",children:\"No employees found\"})})})]})})]})})})})});}export default Teams;","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","Card","CardHeader","CardBody","CardTitle","Table","Row","Col","Badge","Alert","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Teams","employees","setEmployees","loading","setLoading","accessDenied","setAccessDenied","loggedInUser","setLoggedInUser","searchParams","uid","get","userData","localStorage","getItem","parsedUser","JSON","parse","employee_id","fetchEmployees","response","fetch","data","json","success","error","console","getInitials","name","split","map","n","join","toUpperCase","className","children","md","color","tag","responsive","colSpan","length","employee","style","backgroundColor","width","height","borderRadius","display","alignItems","justifyContent","fontWeight","fontSize","full_name","email","department","role","manager_name"],"sources":["/home/kali/projects/mbti/idor_lab/portal/src/views/Teams.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport {\n  Card,\n  CardHeader,\n  CardBody,\n  CardTitle,\n  Table,\n  Row,\n  Col,\n  Badge,\n  Alert,\n} from \"reactstrap\";\n\nfunction Teams() {\n  const [employees, setEmployees] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [accessDenied, setAccessDenied] = useState(false);\n  const [loggedInUser, setLoggedInUser] = useState(null);\n  const [searchParams] = useSearchParams();\n  const uid = searchParams.get(\"uid\");\n\n  useEffect(() => {\n    const userData = localStorage.getItem(\"user\");\n    if (userData) {\n      const parsedUser = JSON.parse(userData);\n      setLoggedInUser(parsedUser);\n\n      // Check if the uid in URL matches the logged-in user\n      if (uid && uid !== parsedUser.employee_id) {\n        setAccessDenied(true);\n      } else {\n        setAccessDenied(false);\n        fetchEmployees();\n      }\n    }\n  }, [uid]);\n\n  const fetchEmployees = async () => {\n    try {\n      const response = await fetch(\"/api/employees.php\");\n      const data = await response.json();\n      if (data.success) {\n        setEmployees(data.data);\n      }\n    } catch (error) {\n      console.error(\"Error fetching employees:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getInitials = (name) => {\n    return name\n      .split(\" \")\n      .map((n) => n[0])\n      .join(\"\")\n      .toUpperCase();\n  };\n\n  if (accessDenied) {\n    return (\n      <div className=\"content\">\n        <Row>\n          <Col md=\"12\">\n            <Card>\n              <CardBody>\n                <Alert color=\"danger\">\n                  <h4 className=\"alert-heading\">Access Denied</h4>\n                  <p>\n                    You don't have permission to view this page. You are trying to access data for user ID: <strong>{uid}</strong>\n                  </p>\n                  <p>\n                    Your user ID is: <strong>{loggedInUser?.employee_id}</strong>\n                  </p>\n                  <hr />\n                  <p className=\"mb-0\">\n                    Please use the navigation menu to access your own data.\n                  </p>\n                </Alert>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"content\">\n        <Row>\n          <Col md=\"12\">\n            <Card>\n              <CardHeader>\n                <CardTitle tag=\"h4\">Team Members</CardTitle>\n                <p className=\"card-category\">All employees in the organization</p>\n              </CardHeader>\n              <CardBody>\n                <Table responsive>\n                  <thead className=\"text-primary\">\n                    <tr>\n                      <th>ID</th>\n                      <th>Name</th>\n                      <th>Email</th>\n                      <th>Department</th>\n                      <th>Role</th>\n                      <th>Manager</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {loading ? (\n                      <tr>\n                        <td colSpan=\"6\" className=\"text-center\">\n                          Loading...\n                        </td>\n                      </tr>\n                    ) : employees.length > 0 ? (\n                      employees.map((employee) => (\n                        <tr key={employee.employee_id}>\n                          <td>{employee.employee_id}</td>\n                          <td>\n                            <div className=\"d-flex align-items-center\">\n                              <div\n                                className=\"avatar mr-2\"\n                                style={{\n                                  backgroundColor: \"#51cbce\",\n                                  width: \"30px\",\n                                  height: \"30px\",\n                                  borderRadius: \"50%\",\n                                  display: \"flex\",\n                                  alignItems: \"center\",\n                                  justifyContent: \"center\",\n                                  color: \"white\",\n                                  fontWeight: \"bold\",\n                                  fontSize: \"12px\",\n                                }}\n                              >\n                                {getInitials(employee.full_name)}\n                              </div>\n                              {employee.full_name}\n                            </div>\n                          </td>\n                          <td>{employee.email}</td>\n                          <td>\n                            <Badge color=\"info\">{employee.department}</Badge>\n                          </td>\n                          <td>{employee.role}</td>\n                          <td>{employee.manager_name || \"N/A\"}</td>\n                        </tr>\n                      ))\n                    ) : (\n                      <tr>\n                        <td colSpan=\"6\" className=\"text-center\">\n                          No employees found\n                        </td>\n                      </tr>\n                    )}\n                  </tbody>\n                </Table>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    </>\n  );\n}\n\nexport default Teams;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}