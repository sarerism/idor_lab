{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate,useSearchParams}from\"react-router-dom\";import{Card,CardHeader,CardBody,CardTitle,Table,Row,Col,Button,Badge}from\"reactstrap\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Reports(){const[loading,setLoading]=useState(true);const[selectedReport,setSelectedReport]=useState(null);const[searchParams]=useSearchParams();const navigate=useNavigate();const reportId=searchParams.get(\"report_id\");useEffect(()=>{if(!reportId){// Redirect to most recent report (512) when no report_id specified\nnavigate(\"/reports?report_id=512\",{replace:true});return;}fetchReportById(parseInt(reportId));},[reportId,navigate]);const fetchReportById=async id=>{try{setLoading(true);const response=await fetch(\"/api/reports.php?id=\".concat(id));const data=await response.json();if(data.success){setSelectedReport(data.data);}else{setSelectedReport(null);}}catch(error){console.error(\"Error fetching report:\",error);setSelectedReport(null);}finally{setLoading(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:\"Loading...\"})});}// Show individual report view\nif(reportId&&selectedReport){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{md:\"6\",children:[/*#__PURE__*/_jsxs(CardTitle,{tag:\"h4\",children:[\"Report #\",selectedReport.id,selectedReport.is_confidential&&/*#__PURE__*/_jsx(Badge,{color:\"danger\",className:\"ml-2\",children:\"CONFIDENTIAL\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"card-category\",children:selectedReport.report_title})]})})}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Col,{md:\"6\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Employee:\"}),\" \",selectedReport.employee_name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Employee ID:\"}),\" \",selectedReport.employee_id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Department:\"}),\" \",selectedReport.employee_id===\"MBTI2024837\"?\"EPA\":selectedReport.employee_id===\"MBTI2024999\"?\"Management\":\"Various\"]})]}),/*#__PURE__*/_jsxs(Col,{md:\"6\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Submitted:\"}),\" \",new Date(selectedReport.submitted_at).toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",/*#__PURE__*/_jsx(Badge,{color:selectedReport.status===\"approved\"?\"success\":\"warning\",children:selectedReport.status})]})]})]}),/*#__PURE__*/_jsx(Card,{className:\"mb-3\",children:/*#__PURE__*/_jsx(CardBody,{style:{backgroundColor:\"#f8f9fa\",maxHeight:\"500px\",overflowY:\"auto\",whiteSpace:\"pre-wrap\",fontFamily:\"monospace\",fontSize:\"13px\",lineHeight:\"1.6\"},children:selectedReport.report_content})})]})]})})})});}// Show report not found\nif(reportId&&!selectedReport){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardBody,{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Report Not Found\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted\",children:[\"Report #\",reportId,\" does not exist.\"]})]})})})})});}// Fallback - should never reach here due to redirect\nreturn null;}export default Reports;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useSearchParams","Card","CardHeader","CardBody","CardTitle","Table","Row","Col","Button","Badge","jsx","_jsx","jsxs","_jsxs","Reports","loading","setLoading","selectedReport","setSelectedReport","searchParams","navigate","reportId","get","replace","fetchReportById","parseInt","id","response","fetch","concat","data","json","success","error","console","className","children","md","tag","is_confidential","color","report_title","employee_name","employee_id","Date","submitted_at","toLocaleString","status","style","backgroundColor","maxHeight","overflowY","whiteSpace","fontFamily","fontSize","lineHeight","report_content"],"sources":["/home/kali/projects/mbti/idor_lab/portal/src/views/Reports.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport {\n    Card,\n    CardHeader,\n    CardBody,\n    CardTitle,\n    Table,\n    Row,\n    Col,\n    Button,\n    Badge,\n} from \"reactstrap\";\n\nfunction Reports() {\n    const [loading, setLoading] = useState(true);\n    const [selectedReport, setSelectedReport] = useState(null);\n    const [searchParams] = useSearchParams();\n    const navigate = useNavigate();\n    const reportId = searchParams.get(\"report_id\");\n\n    useEffect(() => {\n        if (!reportId) {\n            // Redirect to most recent report (512) when no report_id specified\n            navigate(\"/reports?report_id=512\", { replace: true });\n            return;\n        }\n        fetchReportById(parseInt(reportId));\n    }, [reportId, navigate]);\n\n\n\n    const fetchReportById = async (id) => {\n        try {\n            setLoading(true);\n            const response = await fetch(`/api/reports.php?id=${id}`);\n            const data = await response.json();\n            if (data.success) {\n                setSelectedReport(data.data);\n            } else {\n                setSelectedReport(null);\n            }\n        } catch (error) {\n            console.error(\"Error fetching report:\", error);\n            setSelectedReport(null);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n\n\n    if (loading) {\n        return (\n            <div className=\"content\">\n                <div className=\"text-center\">Loading...</div>\n            </div>\n        );\n    }\n\n    // Show individual report view\n    if (reportId && selectedReport) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardHeader>\n                                <Row>\n                                    <Col md=\"6\">\n                                        <CardTitle tag=\"h4\">\n                                            Report #{selectedReport.id}\n                                            {selectedReport.is_confidential && (\n                                                <Badge color=\"danger\" className=\"ml-2\">\n                                                    CONFIDENTIAL\n                                                </Badge>\n                                            )}\n                                        </CardTitle>\n                                        <p className=\"card-category\">{selectedReport.report_title}</p>\n                                    </Col>\n                                </Row>\n                            </CardHeader>\n                            <CardBody>\n                                <Row className=\"mb-3\">\n                                    <Col md=\"6\">\n                                        <p className=\"mb-2\">\n                                            <strong>Employee:</strong> {selectedReport.employee_name}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Employee ID:</strong> {selectedReport.employee_id}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Department:</strong>{\" \"}\n                                            {selectedReport.employee_id === \"MBTI2024837\"\n                                                ? \"EPA\"\n                                                : selectedReport.employee_id === \"MBTI2024999\"\n                                                    ? \"Management\"\n                                                    : \"Various\"}\n                                        </p>\n                                    </Col>\n                                    <Col md=\"6\">\n                                        <p className=\"mb-2\">\n                                            <strong>Submitted:</strong>{\" \"}\n                                            {new Date(selectedReport.submitted_at).toLocaleString()}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Status:</strong>{\" \"}\n                                            <Badge\n                                                color={\n                                                    selectedReport.status === \"approved\" ? \"success\" : \"warning\"\n                                                }\n                                            >\n                                                {selectedReport.status}\n                                            </Badge>\n                                        </p>\n                                    </Col>\n                                </Row>\n\n                                <Card className=\"mb-3\">\n                                    <CardBody\n                                        style={{\n                                            backgroundColor: \"#f8f9fa\",\n                                            maxHeight: \"500px\",\n                                            overflowY: \"auto\",\n                                            whiteSpace: \"pre-wrap\",\n                                            fontFamily: \"monospace\",\n                                            fontSize: \"13px\",\n                                            lineHeight: \"1.6\",\n                                        }}\n                                    >\n                                        {selectedReport.report_content}\n                                    </CardBody>\n                                </Card>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Show report not found\n    if (reportId && !selectedReport) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardBody className=\"text-center\">\n                                <h4>Report Not Found</h4>\n                                <p className=\"text-muted\">Report #{reportId} does not exist.</p>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Fallback - should never reach here due to redirect\n    return null;\n}\n\nexport default Reports;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}