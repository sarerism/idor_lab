{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate,useSearchParams}from\"react-router-dom\";import{Card,CardHeader,CardBody,CardTitle,Table,Row,Col,Button,Badge,Alert}from\"reactstrap\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Reports(){const[searchParams]=useSearchParams();const[accessDenied,setAccessDenied]=useState(false);const[loggedInUser,setLoggedInUser]=useState(null);const uid=searchParams.get(\"uid\");useEffect(()=>{const userData=localStorage.getItem(\"user\");if(userData){const parsedUser=JSON.parse(userData);setLoggedInUser(parsedUser);// Check if the uid in URL matches the logged-in user\nif(uid&&uid!==parsedUser.employee_id){setAccessDenied(true);}else{setAccessDenied(false);}}},[uid]);if(accessDenied){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Alert,{color:\"danger\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"alert-heading\",children:\"Access Denied\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You don't have permission to view this page. You are trying to access data for user ID: \",/*#__PURE__*/_jsx(\"strong\",{children:uid})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Your user ID is: \",/*#__PURE__*/_jsx(\"strong\",{children:loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.employee_id})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-0\",children:\"Please use the navigation menu to access your own data.\"})]})})})})})});}// Show empty state - no reports available\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(CardTitle,{tag:\"h4\",children:\"Reports\"})}),/*#__PURE__*/_jsxs(CardBody,{className:\"text-center\",style:{padding:\"60px 20px\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"nc-icon nc-paper\",style:{fontSize:\"64px\",color:\"#ccc\",marginBottom:\"20px\"}}),/*#__PURE__*/_jsx(\"h4\",{children:\"No Reports Available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"There are currently no reports to display.\"})]})]})})})});}// Old code - keeping for reference if reports are added back\n/*\nfunction ReportsOld() {\n    const [loading, setLoading] = useState(true);\n    const [selectedReport, setSelectedReport] = useState(null);\n    const [searchParams] = useSearchParams();\n    const navigate = useNavigate();\n    const reportId = searchParams.get(\"report_id\");\n\n    useEffect(() => {\n        if (!reportId) {\n            // Redirect to most recent report (502) when no report_id specified\n            navigate(\"/reports?report_id=502\", { replace: true });\n            return;\n        }\n        fetchReportById(parseInt(reportId));\n    }, [reportId, navigate]);\n\n\n\n    const fetchReportById = async (id) => {\n        try {\n            setLoading(true);\n            const response = await fetch(`/api/reports.php?id=${id}`);\n            const data = await response.json();\n            if (data.success) {\n                setSelectedReport(data.data);\n            } else {\n                setSelectedReport(null);\n            }\n        } catch (error) {\n            console.error(\"Error fetching report:\", error);\n            setSelectedReport(null);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n\n\n    if (loading) {\n        return (\n            <div className=\"content\">\n                <div className=\"text-center\">Loading...</div>\n            </div>\n        );\n    }\n\n    // Show individual report view\n    if (reportId && selectedReport) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardHeader>\n                                <Row>\n                                    <Col md=\"6\">\n                                        <CardTitle tag=\"h4\">\n                                            Report #{selectedReport.id}\n                                            {selectedReport.is_confidential && (\n                                                <Badge color=\"danger\" className=\"ml-2\">\n                                                    CONFIDENTIAL\n                                                </Badge>\n                                            )}\n                                        </CardTitle>\n                                        <p className=\"card-category\">{selectedReport.report_title}</p>\n                                    </Col>\n                                </Row>\n                            </CardHeader>\n                            <CardBody>\n                                <Row className=\"mb-3\">\n                                    <Col md=\"6\">\n                                        <p className=\"mb-2\">\n                                            <strong>Employee:</strong> {selectedReport.employee_name}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Employee ID:</strong> {selectedReport.employee_id}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Department:</strong>{\" \"}\n                                            {selectedReport.employee_id === \"MBTI2024837\"\n                                                ? \"EPA\"\n                                                : selectedReport.employee_id === \"MBTI2024999\"\n                                                    ? \"Management\"\n                                                    : \"Various\"}\n                                        </p>\n                                    </Col>\n                                    <Col md=\"6\">\n                                        <p className=\"mb-2\">\n                                            <strong>Submitted:</strong>{\" \"}\n                                            {new Date(selectedReport.submitted_at).toLocaleString()}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Status:</strong>{\" \"}\n                                            <Badge\n                                                color={\n                                                    selectedReport.status === \"approved\" ? \"success\" : \"warning\"\n                                                }\n                                            >\n                                                {selectedReport.status}\n                                            </Badge>\n                                        </p>\n                                    </Col>\n                                </Row>\n\n                                <Card className=\"mb-3\">\n                                    <CardBody\n                                        style={{\n                                            backgroundColor: \"#f8f9fa\",\n                                            maxHeight: \"500px\",\n                                            overflowY: \"auto\",\n                                            whiteSpace: \"pre-wrap\",\n                                            fontFamily: \"monospace\",\n                                            fontSize: \"13px\",\n                                            lineHeight: \"1.6\",\n                                        }}\n                                    >\n                                        {selectedReport.report_content}\n                                    </CardBody>\n                                </Card>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Show report not found\n    if (reportId && !selectedReport) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardBody className=\"text-center\">\n                                <h4>Report Not Found</h4>\n                                <p className=\"text-muted\">Report #{reportId} does not exist.</p>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Fallback - should never reach here due to redirect\n    return null;\n}\n*/export default Reports;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useSearchParams","Card","CardHeader","CardBody","CardTitle","Table","Row","Col","Button","Badge","Alert","jsx","_jsx","jsxs","_jsxs","Reports","searchParams","accessDenied","setAccessDenied","loggedInUser","setLoggedInUser","uid","get","userData","localStorage","getItem","parsedUser","JSON","parse","employee_id","className","children","md","color","tag","style","padding","fontSize","marginBottom"],"sources":["/home/kali/projects/mbti/idor_lab/portal/src/views/Reports.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport {\n    Card,\n    CardHeader,\n    CardBody,\n    CardTitle,\n    Table,\n    Row,\n    Col,\n    Button,\n    Badge,\n    Alert,\n} from \"reactstrap\";\n\nfunction Reports() {\n    const [searchParams] = useSearchParams();\n    const [accessDenied, setAccessDenied] = useState(false);\n    const [loggedInUser, setLoggedInUser] = useState(null);\n    const uid = searchParams.get(\"uid\");\n\n    useEffect(() => {\n        const userData = localStorage.getItem(\"user\");\n        if (userData) {\n            const parsedUser = JSON.parse(userData);\n            setLoggedInUser(parsedUser);\n            \n            // Check if the uid in URL matches the logged-in user\n            if (uid && uid !== parsedUser.employee_id) {\n                setAccessDenied(true);\n            } else {\n                setAccessDenied(false);\n            }\n        }\n    }, [uid]);\n\n    if (accessDenied) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardBody>\n                                <Alert color=\"danger\">\n                                    <h4 className=\"alert-heading\">Access Denied</h4>\n                                    <p>\n                                        You don't have permission to view this page. You are trying to access data for user ID: <strong>{uid}</strong>\n                                    </p>\n                                    <p>\n                                        Your user ID is: <strong>{loggedInUser?.employee_id}</strong>\n                                    </p>\n                                    <hr />\n                                    <p className=\"mb-0\">\n                                        Please use the navigation menu to access your own data.\n                                    </p>\n                                </Alert>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Show empty state - no reports available\n    return (\n        <div className=\"content\">\n            <Row>\n                <Col md=\"12\">\n                    <Card>\n                        <CardHeader>\n                            <CardTitle tag=\"h4\">Reports</CardTitle>\n                        </CardHeader>\n                        <CardBody className=\"text-center\" style={{ padding: \"60px 20px\" }}>\n                            <i className=\"nc-icon nc-paper\" style={{ fontSize: \"64px\", color: \"#ccc\", marginBottom: \"20px\" }}></i>\n                            <h4>No Reports Available</h4>\n                            <p className=\"text-muted\">There are currently no reports to display.</p>\n                        </CardBody>\n                    </Card>\n                </Col>\n            </Row>\n        </div>\n    );\n}\n\n// Old code - keeping for reference if reports are added back\n/*\nfunction ReportsOld() {\n    const [loading, setLoading] = useState(true);\n    const [selectedReport, setSelectedReport] = useState(null);\n    const [searchParams] = useSearchParams();\n    const navigate = useNavigate();\n    const reportId = searchParams.get(\"report_id\");\n\n    useEffect(() => {\n        if (!reportId) {\n            // Redirect to most recent report (502) when no report_id specified\n            navigate(\"/reports?report_id=502\", { replace: true });\n            return;\n        }\n        fetchReportById(parseInt(reportId));\n    }, [reportId, navigate]);\n\n\n\n    const fetchReportById = async (id) => {\n        try {\n            setLoading(true);\n            const response = await fetch(`/api/reports.php?id=${id}`);\n            const data = await response.json();\n            if (data.success) {\n                setSelectedReport(data.data);\n            } else {\n                setSelectedReport(null);\n            }\n        } catch (error) {\n            console.error(\"Error fetching report:\", error);\n            setSelectedReport(null);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n\n\n    if (loading) {\n        return (\n            <div className=\"content\">\n                <div className=\"text-center\">Loading...</div>\n            </div>\n        );\n    }\n\n    // Show individual report view\n    if (reportId && selectedReport) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardHeader>\n                                <Row>\n                                    <Col md=\"6\">\n                                        <CardTitle tag=\"h4\">\n                                            Report #{selectedReport.id}\n                                            {selectedReport.is_confidential && (\n                                                <Badge color=\"danger\" className=\"ml-2\">\n                                                    CONFIDENTIAL\n                                                </Badge>\n                                            )}\n                                        </CardTitle>\n                                        <p className=\"card-category\">{selectedReport.report_title}</p>\n                                    </Col>\n                                </Row>\n                            </CardHeader>\n                            <CardBody>\n                                <Row className=\"mb-3\">\n                                    <Col md=\"6\">\n                                        <p className=\"mb-2\">\n                                            <strong>Employee:</strong> {selectedReport.employee_name}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Employee ID:</strong> {selectedReport.employee_id}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Department:</strong>{\" \"}\n                                            {selectedReport.employee_id === \"MBTI2024837\"\n                                                ? \"EPA\"\n                                                : selectedReport.employee_id === \"MBTI2024999\"\n                                                    ? \"Management\"\n                                                    : \"Various\"}\n                                        </p>\n                                    </Col>\n                                    <Col md=\"6\">\n                                        <p className=\"mb-2\">\n                                            <strong>Submitted:</strong>{\" \"}\n                                            {new Date(selectedReport.submitted_at).toLocaleString()}\n                                        </p>\n                                        <p className=\"mb-2\">\n                                            <strong>Status:</strong>{\" \"}\n                                            <Badge\n                                                color={\n                                                    selectedReport.status === \"approved\" ? \"success\" : \"warning\"\n                                                }\n                                            >\n                                                {selectedReport.status}\n                                            </Badge>\n                                        </p>\n                                    </Col>\n                                </Row>\n\n                                <Card className=\"mb-3\">\n                                    <CardBody\n                                        style={{\n                                            backgroundColor: \"#f8f9fa\",\n                                            maxHeight: \"500px\",\n                                            overflowY: \"auto\",\n                                            whiteSpace: \"pre-wrap\",\n                                            fontFamily: \"monospace\",\n                                            fontSize: \"13px\",\n                                            lineHeight: \"1.6\",\n                                        }}\n                                    >\n                                        {selectedReport.report_content}\n                                    </CardBody>\n                                </Card>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Show report not found\n    if (reportId && !selectedReport) {\n        return (\n            <div className=\"content\">\n                <Row>\n                    <Col md=\"12\">\n                        <Card>\n                            <CardBody className=\"text-center\">\n                                <h4>Report Not Found</h4>\n                                <p className=\"text-muted\">Report #{reportId} does not exist.</p>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n\n    // Fallback - should never reach here due to redirect\n    return null;\n}\n*/\n\nexport default Reports;\n"],"mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAEA,cAAe,CAAAhB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}